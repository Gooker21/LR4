# АНАЛИЗ ДАННЫХ И ИСКУССТВЕННЫЙ ИНТЕЛЛЕКТ [in GameDev]
Отчет по лабораторной работе #4 выполнил(а):
- Корабельников Виталий Вадимович
- НМТ-213929
Отметка о выполнении заданий (заполняется студентом):

| Задание | Выполнение | Баллы |
| ------ | ------ | ------ |
| Задание 1 | * | 60 |
| Задание 2 | * | 20 |
| Задание 3 | * | 20 |

знак "*" - задание выполнено; знак "#" - задание не выполнено;

Работу проверили:
- к.т.н., доцент Денисов Д.В.
- к.э.н., доцент Панов М.А.
- ст. преп., Фадеев В.О.

[![N|Solid](https://cldup.com/dTxpPi9lDf.thumb.png)](https://nodesource.com/products/nsolid)

[![Build Status](https://travis-ci.org/joemccann/dillinger.svg?branch=master)](https://travis-ci.org/joemccann/dillinger)

Структура отчета

- Данные о работе: название работы, фио, группа, выполненные задания.
- Цель работы.
- Задание 1.
- Код реализации выполнения задания. Визуализация результатов выполнения (если применимо).
- Задание 2.
- Код реализации выполнения задания. Визуализация результатов выполнения (если применимо).
- Задание 3.
- Код реализации выполнения задания. Визуализация результатов выполнения (если применимо).
- Выводы.
- ✨Magic ✨

## Цель работы
Познакомиться с перцептроном и реализовать его в проекте Unity.

## Задание 1
### В проекте Unity реализовать перцептрон, который умеет производить вычисления OR, AND, NAND, XOR.
Ход работы:
- Создал новый 3D проект в Unity, скачал `Perceptron.cs`, с предоставленного репозитория, и накинул этот скрипт на пустой GameObject.
![1](https://user-images.githubusercontent.com/58142149/204633438-28d4e6dc-9391-40cf-b1c7-8f39912395cc.png)

- Добавил `public` поле `epoches`, для более удобного взаимодействия с эпохами.

![image](https://user-images.githubusercontent.com/58142149/204637054-fb234539-d232-4dd9-8eca-f6d4f8eaa8d6.png)


____

### OR
- В первую очередь, настроил `TrainingSet` на обучение вычисления логического `ИЛИ` | `OR`.

![Screenshot_1](https://user-images.githubusercontent.com/58142149/204633815-35cd5eaa-d24b-457d-887a-adb3761b876d.png)

- Для проверки запустил обучение на `1` эпохе... Результат очевидный - перцептрон не обучился.

![1 epoha](https://user-images.githubusercontent.com/58142149/204633930-3fad8538-5144-47bb-84f6-22b2a52e0e21.png

- Повышаем ставки! Обучение на `4`-х эпохах. Тут результат уже неоднозначный, перцептрон то успевает обучиться, то нет

`НE` `обучился`:

![4epoha false (желательно при 6 и больше, поскольку даже при 5 иногда проскакивал не верный ответ)](https://user-images.githubusercontent.com/58142149/204634255-2bef0a53-410b-4417-98b7-1691472f282c.png)

`Обучился`:

![4 epoha true](https://user-images.githubusercontent.com/58142149/204634289-85b13290-1d25-4269-ab61-1c2aec871bf0.png)

__Желательно обучать при `6` эпохах или более, поскольку даже при `5` иногда проскакивал не верный ответ__


### AND

- Всё аналогично логическому выражению OR, заострять внимание не буду

- `1` эпоха

![1](https://user-images.githubusercontent.com/58142149/204643272-54c91c2c-e0b2-4f2f-bd5a-e21fadc29990.png)

- `6` эпох, обучился с 4-й

![Screenshot_1](https://user-images.githubusercontent.com/58142149/204643342-8a8343b2-c19b-4136-aa7b-801ca605ab0c.png)


### NAND

- Поскольку `AND` и `NAND` отличаются только инвертированными значениями, то и не вижу смысла описывать всё как выше.

![image](https://user-images.githubusercontent.com/58142149/204643947-b6f65ed9-01f6-4695-a9f1-44e61d364299.png)


### XOR

- А вот с `XOR` всё куда интереснее! Перцептрон с каждой эпохой только увеличивал `TotalError`, поскольку перцептрон работает только с линейными функциями, коей `XOR` НЕ является!

- `2` эпохи

![Screenshot_2](https://user-images.githubusercontent.com/58142149/204645144-a8d29e59-e5d5-440b-810f-c159e3cccdc9.png)

- `6` эпох

![Screenshot_1](https://user-images.githubusercontent.com/58142149/204645127-2aaf6d49-2a05-48d8-adad-bad579628c51.png)


#### Следовательно, перцептрон обучается только на линейных функциях, а обучиться на нелинейных, таких как XOR,- не сможет и будет выводить некорректный результат.
____

## Задание 2
### Построить графики зависимости количества эпох от ошибки обучения. Указать от чего зависит необходимое количество эпох обучения.

-Построил графики `СРЕДНИХ ЗНАЧЕНИЙ` из `5` независимых эпох для логических выражений `OR`, `AND`, `NAND` и `XOR`.

![image](https://user-images.githubusercontent.com/58142149/204656548-44dae6f4-e799-449b-8e07-2467d79c179f.png)

### Итоги Задания 2

#### Судя по графику, для логического выражения `OR`, в среднем, требуется меньше эпох для обучения перцептрона, чего нельзя сказать о `AND` и `NAND`, которым явно требуется больше эпох для обучения, и, желательно, чтобы количество их превышало `восьми`. А график зависимости средних значений от эпох выражения `XOR` ещё раз наглядно даёт понять, что перцептрон не может обучиться, и с каждой новой эпохой его `TotalError` увеличивается.



#### Необходимое количество эпох обучения зависит от `bias` (смещения) и `weights` (весов). Это можно увидеть из части кода скрипта `Perceptron.cs`

```cs
	double DotProductBias(double[] v1, double[] v2) 
	{
		if (v1 == null || v2 == null)
			return -1;
	 
		if (v1.Length != v2.Length)
			return -1;
	 
		double d = 0;
		for (int x = 0; x < v1.Length; x++)
		{
			d += v1[x] * v2[x];
		}

		d += bias;
	 
		return d;
	}
```

____

## Задание 3
### Построить визуальную модель работы перцептрона на сцене Unity.

- Дописал в `Perceptron.cs` _OnTriggerEnter_, как можно догадаться по коду снизу, зелёный - `1`, красный - `0`.

```cs 
	private int isGreen(Color color) => color == Color.green ? 1 : 0;

    void OnTriggerEnter(Collider other)
    {
        var firstCube = isGreen(this.gameObject.GetComponent<Renderer>().material.color);

        var secondCube = isGreen(other.gameObject.GetComponent<Renderer>().material.color);

        var outputColor = CalcOutput(firstCube, secondCube) > 0 ? Color.green : Color.red;

        this.gameObject.GetComponent<Renderer>().material.color = outputColor;
        Destroy(other.gameObject);
    }
```

- Создал сцену с 8 кубиками, к тем, что снизу, прикрепил скрипт и менял значения под выражения `OR`, `AND`, `NAND` и `XOR` + сменил флажок _isTrigger_, в коллайдере, а к кубикам, которые расположены сверху - накинул компонент _Rigidbody_.


#### OR

![OR](https://user-images.githubusercontent.com/58142149/204671232-3f2def01-f0b8-4144-be0d-a24c77b10241.gif)


#### AND

![AND](https://user-images.githubusercontent.com/58142149/204671248-d9714663-9b45-4a13-ad50-29abf55fb220.gif)


#### NAND

![NAND](https://user-images.githubusercontent.com/58142149/204671263-f4b8fc01-65e3-4804-ab90-d95db5bad1ba.gif)


#### XOR - ну конечно же он не будет корректно работать...

![XOR](https://user-images.githubusercontent.com/58142149/204671288-6f07ede9-0a43-4d81-baec-e571cb8e0338.gif)


____

## Выводы
- Узнал что такое перцептрон, его алгоритм работы.
- Реализовал в Unity перцептрон, которого обучил производить корректные логические операции `OR`, `AND` и `NAND`. Почитал доп. литературу на счёт проблемы `XOR`. 
- Построил графики зависимости числа эпох от ошибки обучения для каждой итерации. 
- Визуализировал работу перцептрона в Unity.


## Powered by

**BigDigital Team: Denisov | Fadeev | Panov**

